import{isDef as b,isString as S,ensureEndingSlash as F,entries as L,useLocaleConfig as y}from"@vuepress/helper/client";import{useScrollLock as P}from"@vueuse/core";import{defineComponent as C,ref as g,onMounted as D,watch as T,onUnmounted as I,h as c}from"vue";import{checkIsiPad as R,checkIsMobile as U,checkIsSafari as $,CancelFullScreenIcon as E,EnterFullScreenIcon as M}from"vuepress-shared/client";import"../styles/pdf.scss";import{withBase as N}from"vuepress/client";import{u as k}from"../useSize-C8GaR9if.js";import{g as z}from"../getLink-DBmDl_2w.js";const p=e=>{console.error(`[PDF]: ${e}`)},j=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},B=e=>e==="string"?document.querySelector(e):e instanceof HTMLElement?e:document.body,H=e=>{let t="";return e&&(t+=L(e).map(([o,r])=>o==="noToolbar"?`toolbar=${r?0:1}`:`${encodeURIComponent(o)}=${encodeURIComponent(r)}`).join("&"),t&&(t=`#${t.slice(0,t.length-1)}`)),t},m=(e,t,o,r,l)=>{j(t);const u=`${e==="pdfjs"?`${F(N(PDFJS_URL))}web/viewer.html?file=${encodeURIComponent(o)}`:o}${H(r)}`,i=e==="pdfjs"||e==="iframe"?"iframe":"embed",n=document.createElement(i);return n.className="pdf-viewer",n.type="application/pdf",n.title=l,n.src=u,n instanceof HTMLIFrameElement&&(n.allow="fullscreen"),t.classList.add("pdf-viewer-container"),t.appendChild(n),t.getElementsByTagName(i)[0]},J=(e,t,{title:o,hint:r,options:l={},force:u})=>{if(typeof window>"u"||!window?.navigator?.userAgent)return null;const{navigator:i}=window,{userAgent:n}=i,d=b(window.Promise),a=R(n)||U(n),v=!a&&$(n),h=!a&&/firefox/iu.test(n)&&n.split("rv:").length>1?parseInt(n.split("rv:")[1].split(".")[0],10)>18:!1,w=!a&&(d||h);if(!S(e))return p("URL is not valid"),null;const s=B(t);if(!s)return p("Target element cannot be determined"),null;const f=(o||/\/([^/]+).pdf/.exec(e)?.[1])??"PDF Viewer";return u?PDFJS_URL?m("pdfjs",s,e,l,f):(s.innerHTML=r.replace(/\[url\]/g,e),p("PDFJS URL is not defined"),null):w||!a?m(v?"iframe":"embed",s,e,l,f):PDFJS_URL?m("pdfjs",s,e,l,f):(s.innerHTML=r.replace(/\[url\]/g,e),p("This browser does not support embedded PDFs"),null)};var _=C({name:"PDF",props:{url:{type:String,required:!0},title:{type:String,default:""},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:void 0},ratio:{type:[String,Number],default:16/9},page:{type:[String,Number],default:1},noToolbar:Boolean,noFullscreen:Boolean,zoom:{type:[String,Number],default:100},viewer:Boolean},setup(e){const{el:t,width:o,height:r,resize:l}=k(e),u=y(PDF_LOCALES),i=g(),n=g(!1);return D(()=>{J(z(e.url),i.value,{title:e.title,hint:u.value.hint,options:{page:e.page,noToolbar:e.noToolbar,...e.zoom.toString()==="100"?{}:{zoom:e.zoom}},force:e.viewer}),l();const d=P(document.body);T(n,a=>{d.value=a}),I(()=>{d.value=!1})}),()=>c("div",{class:["pdf-viewer-wrapper",{fullscreen:n.value}],ref:t,style:n.value?{}:{width:o.value,height:r.value}},[c("div",{ref:i}),e.noFullscreen?null:c("button",{class:"pdf-fullscreen-button",onClick:()=>{n.value=!n.value}},c(n.value?E:M,{class:"pdf-fullscreen-icon"}))])}});export{_ as default};
//# sourceMappingURL=PDF.js.map
